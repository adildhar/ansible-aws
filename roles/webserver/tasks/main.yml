---
- name: Clone git repository
  git: dest={{ web_dir }} repo=https://github.com/adildhar/symfony.git update=no
  become: yes
  register: cloned

- name: install composer
  shell: curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
  become: yes
  args:
    creates: /usr/local/bin/composer

- ec2_remote_facts:
    filters:
      instance-state-name: running
      "tag:Name": "{{ web_application }}_WEB_Instance"
      "vpc-id": "{{ web_vpc_id }}"

- name: ELB | Adding EC2 instance(s) to the ELB provided
  local_action:
    module: ec2_elb
    region: "{{ web_region }}"
    ec2_elbs: "{{ load_balancer_name }}"
    instance_id: "{{ item }}"
    state: present
  with_items: 
    - "{{ instance_id_1 }}"
    - "{{ instance_id_2 }}"